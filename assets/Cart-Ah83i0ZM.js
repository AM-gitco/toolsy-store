import{j as e}from"./ui-BfOL7Pw6.js";import{f as s,r as t}from"./router-BXFWiZbc.js";import{H as r}from"./Header-CMjDRm3Z.js";import{a as i,C as a,b as l,c}from"./card-BQXi3xZY.js";import{B as d}from"./button-CmvG0lOO.js";import{S as n,c as o,d as m,e as p,f as u}from"./select-CNwGciQv.js";import{I as x}from"./input-zfUHz5B2.js";import{L as h}from"./label-Dbe54ejA.js";import{C as j}from"./CurrencyDisplay-BCzKL-MM.js";import{O as f}from"./OptimizedImage-EQcKTxEc.js";import{a as g,u as y,s as v}from"./index-ud4XQfz4.js";import{S as N}from"./shopping-cart-CxQptf5P.js";import{A as b}from"./arrow-left-Tt42aMK4.js";import{T as _,M as w,P as C}from"./trash-2-B6gUF_4e.js";import{C as k}from"./circle-check-big-DcnsFF-J.js";import{C as P}from"./credit-card-C4EvGjIG.js";import"./vendor-B5BPFqys.js";import"./toolsy-logo-C0HmbZOG.js";import"./CurrencySelector-Dp-scm2k.js";import"./badge-D8FtP9-V.js";import"./shield-BPn5TLBB.js";import"./motion-BU2psJSs.js";import"./supabase-DlLlES7-.js";import"./charts-AXPLIc8O.js";const z=[{id:"shared",name:"Shared",multiplier:1},{id:"semi_private",name:"Semi-Private",multiplier:1.5},{id:"private",name:"Private",multiplier:2}],S=[{id:"1_month",name:"1 Month",multiplier:1},{id:"3_months",name:"3 Months",multiplier:2.5},{id:"6_months",name:"6 Months",multiplier:4.5},{id:"1_year",name:"1 Year",multiplier:8},{id:"2_years",name:"2 Years",multiplier:14},{id:"lifetime",name:"Lifetime",multiplier:25}],q=()=>{const q=s(),{cartItems:A,removeFromCart:I,updateQuantity:M,updateProductPlan:T,clearCart:B,getTotalPrice:E}=g(),{toast:F}=y(),[O,Y]=t.useState({}),H=async e=>{try{const{data:s,error:t}=await v.from("pricing_plans").select("*").eq("product_id",e);if(t)return;s&&Y(t=>({...t,[e]:s}))}catch(s){}};t.useEffect(()=>{(async()=>{const e=A.filter(e=>!e.product.pricing_plans&&!O[e.product.id]);if(0===e.length)return;const s=e.map(e=>e.product.id);try{const{data:e,error:t}=await v.from("pricing_plans").select("*").in("product_id",s);if(t)return;if(e){const s={};e.forEach(e=>{s[e.product_id]||(s[e.product_id]=[]),s[e.product_id].push(e)}),Y(e=>({...e,...s}))}}catch(t){}})()},[A.length]);const L=e=>{const s=e.pricing_plans||O[e.id];if(s&&s.length>0){const e=s.filter(e=>e.is_enabled).map(e=>e.plan_type);return z.filter(s=>e.includes(s.id))}return O[e.id]||H(e.id),z},D=e=>{const s=e.pricing_plans||O[e.id];if(s&&s.length>0){const e=s.filter(e=>e.is_enabled).map(e=>e.monthly_price?"1_month":e.yearly_price?"1_year":"1_month");return S.filter(s=>e.includes(s.id))}return O[e.id]||H(e.id),S},Q=(e,s)=>{s<=0?(I(e),F({title:"Item removed",description:"Product has been removed from your cart."})):M(e,s)},V=(e,s,t)=>{const r=A.find(s=>s.product.id===e);if(!r)return;const i="type"===s?t:r.product.subscription_type,a="period"===s?t:r.product.subscription_period,l=r.product.pricing_plans||O[r.product.id];if(l&&l.length>0){const s=l.find(e=>{const s=e.plan_type===i,t="1_month"===a&&e.monthly_price||"1_year"===a&&e.yearly_price;return s&&t&&e.is_enabled});if(s){const t="1_month"===a?s.monthly_price:s.yearly_price,r=parseFloat(t?.replace(/[^\d.]/g,"")||"0");return T(e,i,a,r),void F({title:"Plan updated",description:"Product plan has been updated successfully."})}}const c=z.find(e=>e.id===i)?.multiplier||1,d=S.find(e=>e.id===a)?.multiplier||1,n=r.product.price/(c*d),o=Math.round(n*c*d);T(e,i,a,o),F({title:"Plan updated",description:"Product plan has been updated successfully."})};return 0===A.length?e.jsxs(e.Fragment,{children:[e.jsx(r,{}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5",children:e.jsx("main",{className:"flex-1 w-full py-12 px-2 sm:px-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-muted rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(N,{className:"w-12 h-12 text-muted-foreground"})}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Your Cart is Empty"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto",children:"Looks like you haven't added any products to your cart yet. Browse our tools and add some products to get started!"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(d,{onClick:()=>q("/tools"),className:"bg-gradient-to-r from-primary to-brand-teal hover:from-primary/90 hover:to-brand-teal/90 text-white",children:"Browse Tools"}),e.jsxs(d,{variant:"outline",onClick:()=>q(-1),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Back"]})]})]})})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(r,{}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5",children:e.jsx("main",{className:"flex-1 w-full py-12 px-2 sm:px-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold bg-gradient-to-r from-primary to-brand-teal bg-clip-text text-transparent",children:"Shopping Cart"}),e.jsxs("p",{className:"text-muted-foreground mt-2",children:[A.length," ",1===A.length?"item":"items"," in your cart"]})]}),e.jsxs(d,{variant:"outline",onClick:()=>{B(),F({title:"Cart cleared",description:"All items have been removed from your cart."})},className:"text-destructive hover:text-destructive",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Clear Cart"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:A.map(s=>e.jsx(i,{className:"overflow-hidden",children:e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"w-full sm:w-32 h-32 bg-muted rounded-lg overflow-hidden flex-shrink-0",children:e.jsx(f,{src:s.product.main_image_url||"/placeholder.svg",alt:s.product.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.product.name}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:s.product.category})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-sm font-medium",children:"Subscription Type"}),e.jsxs(n,{value:s.product.subscription_type,onValueChange:e=>V(s.product.id,"type",e),children:[e.jsx(o,{className:"h-9",children:e.jsx(m,{})}),e.jsx(p,{children:L(s.product).map(s=>e.jsx(u,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(h,{className:"text-sm font-medium",children:"Duration"}),e.jsxs(n,{value:s.product.subscription_period,onValueChange:e=>V(s.product.id,"period",e),children:[e.jsx(o,{className:"h-9",children:e.jsx(m,{})}),e.jsx(p,{children:D(s.product).map(s=>e.jsx(u,{value:s.id,children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"text-sm font-medium",children:"Quantity:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>Q(s.product.id,s.quantity-1),className:"h-8 w-8 p-0",children:e.jsx(w,{className:"w-3 h-3"})}),e.jsx(x,{type:"number",value:s.quantity,onChange:e=>Q(s.product.id,parseInt(e.target.value)||1),className:"w-16 h-8 text-center",min:"1"}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>Q(s.product.id,s.quantity+1),className:"h-8 w-8 p-0",children:e.jsx(C,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold",children:e.jsx(j,{pkrAmount:(s.product.custom_price||s.product.price)*s.quantity,size:"lg"})}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx(j,{pkrAmount:s.product.custom_price||s.product.price,size:"sm"})," each"]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>I(s.product.id),className:"text-destructive hover:text-destructive",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Remove"]})})]})]})})},s.product.id))}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(i,{className:"sticky top-4",children:[e.jsx(l,{children:e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-primary"}),"Order Summary"]})}),e.jsxs(a,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:A.map(s=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s.product.name," Ã— ",s.quantity]}),e.jsx(j,{pkrAmount:(s.product.custom_price||s.product.price)*s.quantity,size:"sm"})]},s.product.id))}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsx(j,{pkrAmount:E(),size:"lg"})]})}),e.jsxs(d,{onClick:()=>{0!==A.length?q("/checkout"):F({title:"Cart is empty",description:"Please add some products to your cart first.",variant:"destructive"})},className:"w-full bg-gradient-to-r from-primary to-brand-teal hover:from-primary/90 hover:to-brand-teal/90 text-white",size:"lg",children:[e.jsx(P,{className:"w-5 h-5 mr-2"}),"Proceed to Checkout"]}),e.jsxs(d,{variant:"outline",onClick:()=>q("/tools"),className:"w-full",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Continue Shopping"]})]})]})})]})]})})})]})},A=()=>e.jsx(q,{});export{A as default};
